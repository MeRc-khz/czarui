<!DOCTYPE HTML>
<html lang ="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=yes" />
<title>Lawn Czar </title>
<style = "text/css">
html { height: 100% }
body { height: 100%; margin: 0; padding: 0; overflow:hidden; }
#map_canvas { height:100%; width:100%; z-index: -1; }
form.zipform
{
position:absolute;
top:0px;
left:0px;
width:350px;
height:200px;
font-family: Tahoma, Geneva, sans-serif;
font-size: 14px;
font-style: italic;
line-height: 24px;
font-weight: bold;
color:#fff;
text-decoration: none;
padding:10px;
z-index:12;
}

form.zipform input[type="button"]:hover
{
background:#fff;
color:#CCF600;
}
form.zipform input[type="button"]:focus
{
border: 1px solid #09C;
}
form.zipform input[type="button"]
{
font-weight: bold;
font-size: 16px;
width:100px;
position:absolute;
right:3.5em;
bottom:2em;
background:#CCF600;
color:#fff;
font-family: Tahoma, Geneva, sans-serif;
height:40px;
-webkit-border-radius: 15px;
-moz-border-radius: 15px;
border-radius: 15px;
border: 1px solid #09C;
}
form.zipform input[type="text"]
{
font-size: 24px;
}
form.zipform input
{
height: 25px;
display:block;
border: 1px solid #09C;
width:300px;
height:40px;
-webkit-border-radius: 5px;
-moz-border-radius: 5px;
border-radius: 5px;
-webkit-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
}
div.zipdiv
{
background-color:#FF7400;
position:absolute;
top:0px;
left0px;
width:20em;
height:200px;
margin-top:75px;
z-index:10;
display:block;
border: 1px solid #09C;
border: inset 1px solid #09C;
-webkit-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
-webkit-border-radius: 5px;
-moz-border-radius: 5px;
border-radius: 5px;
}
div.lucidlay
{
position:absolute;
top:0px;
left:0px;
margin:0px;
padding:0px;
z-index:6;
height:100%;
width:100%;
display:block;
background-color:black;
opacity: .7;
overflow: hidden;
}
div.ctrcvs{
position:absolute;
left:0px;
top:0px;
padding:0px;
z-index:5;
margin:0;
height: 100%;
width:100%;
border:2px solid #FF7400;
}
.cvscss{
margin:0px;
padding:0px;
}
</style>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBSQ_lEToEfCqYF8a3_vmyaiSoj9fAXiXc&sensor=true"></script>
</head>
<body>
<div class="lucidlay" id="lucidlay"></div>
<div class ="zipdiv" id="zipdiv">
<h1>Lawn Czar</h1>
<form class="zipform" id="zipform">
<h3>Enter your Zip Code to get Started!</h3>
Zip Code: <input id="zipput" type="text" name="zipcode">
<input id="zipbutton" type="button" name ="submitzip" value="Lawn Czar">
</form>
</div>
    <div id="map_canvas" style="width:100%; height:100%"></div>
	<div  class = "ctrcvs" id="ctrcvs">
	<button id="button">slide</button>
	</div>
	<script = "text/Javascript">
window.addEventListener('load',initialize, false);

function initialize() {
document.getElementById("map_canvas").style.height = screen.height;
document.getElementById("button").addEventListener("click", hr_pins, false);
document.getElementById("zipbutton").addEventListener("click", zip_encoder, false);
geocoder = new google.maps.Geocoder();

        var mapOptions = {
		disableDefaultUI: true,
          center: new google.maps.LatLng(32.7153, -117.1564),
          zoom: 14,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var czarmap = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);
			
			
	function zip_encoder(){
	var zipdiv = document.getElementById("zipdiv");
	var lucidlay = document.getElementById("lucidlay");
	lucidlay.style.display = "none";
	zipdiv.style.display = "none";
var urzip = document.getElementById("zipput").value;

geocoder.geocode({'address': urzip}, function(results, status){
if(status == google.maps.GeocoderStatus.OK){
czarmap.setCenter(results[0].geometry.location);
}else{
alert('you got problems: ' + status);
}
});

}		
      
function hr_pins(){
var reqCall = new XMLHttpRequest();
reqCall.open("GET", "scripts/lawnczar_marker_data.php", true);
reqCall.setRequestHeader("Content-Type", "application/json");
reqCall.onreadystatechange = function(){
if(reqCall.readyState == 4 && reqCall.status == 200){
var data = JSON.parse(reqCall.responseText);
//alert(data);

for(var obj in data){
var pinpoint = [];
pinpoint[obj] = data[obj].address + " " + data[obj].city +", "+ data[obj].state +" "+ data[obj].zip;
//alert(pinpoint[obj]);
geocoder.geocode({'address': pinpoint[obj]}, function(results, status){
if(status == google.maps.GeocoderStatus.OK){
i = 0;
myLatLng = [];
myLatLng[i] = results[0].geometry.location;
//alert(myLatLng[i]);
czarmap.setCenter(results[0].geometry.location);
czarmap.setZoom(11);
marker = new google.maps.Marker({
map: czarmap,
position: myLatLng[i]});
console.log(marker);
}else{
alert('you got problems: ' + status);
}
//console.log(marker);
//console.log(marker.postion);
});
}
}
}
reqCall.send(null);
document.getElementById("ctrcvs").innerHTML = "processing information....";
}

}
</script>
</body>
</html>