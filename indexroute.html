<!DOCTYPE HTML>
<html lang ="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=yes" />
<title>Lawn Czar </title>
<style = "text/css">
html { height: 100% }
body { height: 100%; margin: 0; padding: 0; overflow:hidden; }
#map_canvas { height:100%; width:100%; z-index: 1; }
form.zipform
{
position:absolute;
top:0px;
left:0px;
width:350px;
height:200px;
font-family: Tahoma, Geneva, sans-serif;
font-size: 14px;
font-style: italic;
line-height: 24px;
font-weight: bold;
color:#fff;
text-decoration: none;
padding:10px;
z-index:12;
}

form.zipform input[type="button"]:hover
{
background:#fff;
color:#CCF600;
}
form.zipform input[type="button"]:focus
{
border: 1px solid #09C;
}
form.zipform input[type="button"]
{
font-weight: bold;
font-size: 16px;
width:100px;
position:absolute;
right:3.5em;
bottom:2em;
background:#CCF600;
color:#fff;
font-family: Tahoma, Geneva, sans-serif;
height:40px;
-webkit-border-radius: 15px;
-moz-border-radius: 15px;
border-radius: 15px;
border: 1px solid #09C;
}
form.zipform input[type="text"]
{
font-size: 24px;
}
form.zipform input
{
height: 25px;
display:block;
border: 1px solid #09C;
width:300px;
height:40px;
-webkit-border-radius: 5px;
-moz-border-radius: 5px;
border-radius: 5px;
-webkit-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
}
div.zipdiv
{
background-color:#FF7400;
position:absolute;
top:0px;
left0px;
width:20em;
height:200px;
margin-top:75px;
z-index:10;
display:block;
border: 1px solid #09C;
border: inset 1px solid #09C;
-webkit-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.3);
-webkit-border-radius: 5px;
-moz-border-radius: 5px;
border-radius: 5px;
}
div.lucidlay
{
position:absolute;
top:0px;
left:0px;
margin:0px;
padding:0px;
z-index:6;
height:100%;
width:100%;
display:block;
background-color:black;
opacity: .7;
overflow: hidden;
}
div.ctrcvs{
position:absolute;
left:0px;
top:0px;
padding:0px;
z-index:5;
margin:0;
height: 100%;
width:100%;
border:2px solid #FF7400;
}
.cvscss{
margin:0px;
padding:0px;
}
div.itinerary
{
display:none;
}
button.btnroute
{
display:none;
}
</style>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBSQ_lEToEfCqYF8a3_vmyaiSoj9fAXiXc&sensor=true"></script>
</head>
<body>
<div class="lucidlay" id="lucidlay"></div>
<div class ="zipdiv" id="zipdiv">

<form class="zipform" id="zipform">
<h1>Lawn Czar</h1>
Enter your Zip Code to get Started! <input id="zipput" type="text" name="zipcode" value="91977">
<input id="zipbutton" type="button" name ="submitzip" value="Lawn Czar">
</form>
</div>
    <div id="map_canvas" style="width:100%; height:100%"></div>
	<div  class = "ctrcvs" id="ctrcvs">
	<button id="button">GET POINTS</button>
	</div>
	<div class ="itinerary" id ="itinerary"><button id="btnroute">Route</button></div>
	<script = "text/Javascript">
window.addEventListener('load', initialize, false);
//////intialize javascript////////////////////////////
var urzip = "";
function initialize() {
    ////get doms///////////////////////
    document.getElementById("map_canvas").style.height = screen.height;
    document.getElementById("button").addEventListener("click", hr_pins, false);
    document.getElementById("zipbutton").addEventListener("click", zip_encoder, false);
  
    //////////////////CZAR MAP/////////////////////////////////////////
    var mapOptions = {
        //disableDefaultUI: true,
        center: new google.maps.LatLng(32.7153, -117.1564),
        zoom: 14,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var czarmap = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
	///route line and line options////////////////////////////////////
    var routeOps = {
          strokeColor: '#000000',
          strokeOpacity: 1.0,
          strokeWeight: 3
        }
        routeLine = new google.maps.Polyline(routeOps);
        routeLine.setMap(czarmap);
		
geocoder = new google.maps.Geocoder();

    ///////////////Take zipcode from form and moves map////            

    function zip_encoder() {
        var zipdiv = document.getElementById("zipdiv");
        var lucidlay = document.getElementById("lucidlay");
        lucidlay.style.display = "none";
        zipdiv.style.display = "none";

        urzip = document.getElementById("zipput").value;

        geocoder.geocode({
            'address': urzip
        }, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
			urzip = results[0].geometry.location;
                czarmap.setCenter(urzip);
            } else {
                alert('you got problems: ' + status);
            }
        });

    }

    ////////////////Place encode coord on map when buttons pushed////////////////////////////    
function hr_pins() {
        var zipbtn = document.getElementById("ctrcvs");
        zipbtn.style.display = "none";	
    
        var reqCall = new XMLHttpRequest();
        reqCall.open("GET", "scripts/lawnczar_marker_data.php", true);
        reqCall.setRequestHeader("Content-Type", "application/json");
        reqCall.onreadystatechange = function() {
            if (reqCall.readyState == 4 && reqCall.status == 200) {
                var data = JSON.parse(reqCall.responseText);
                for (var obj in data) {
                    var pinpoint;
                    pinpoint = data[obj].address + " " + data[obj].city + ", " + data[obj].state + " " + data[obj].zip;
					geocoder.geocode({
                        'address': pinpoint
                    }, function(results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {
						czarmap.setZoom(12);
						czarmap.setCenter(urzip);
                            var marker = new google.maps.Marker({
							position: results[0].geometry.location,
							map:czarmap,
							title: results[0].geometry.location.toString()
							});
						google.maps.event.addListener(marker,'click', makeRoute);

function makeRoute(){
var poi = routeLine.getPath();
poi.push(results[0].geometry.location);
alert("marker: " + results[0].geometry.location.toString());
console.log(results[0].geometry.location.toString());
}						
                        } else {
                            alert('you got problems: ' + status);
                        }
                    });
					
					
                }
			
            }
        }
        reqCall.send(null);
        //document.getElementById("ctrcvs").innerHTML = "processing information....";
        
		

			   
        }
		
		function findWay(map, location) {
		 for (var m = 0; m < location.length; m++) {
            var spot = location[m];
			alert(spot);
            var marker = new google.maps.Marker({
                map: czarmap,
                position: spot
            });
        }
		
		//google.maps.event.addListener(marker, 'click', wayThere);
		//function wayThere(){
		//var way = route.getPath();
          //  way.push(event.position);
            //alert(way.getAt(i));
            //alert(marker[i].position);
		}
    }
</script>
</body>
</html>